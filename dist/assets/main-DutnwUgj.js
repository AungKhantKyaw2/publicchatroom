import{c as X,o as q,q as L,a as O,w as Y,T as $,b as E,d as H}from"./main-dFlaZv2F.js";import{t as h,n as b,g as C,a as F,e as U,m as T,b as y}from"./uielement-BXN331TX.js";/* empty css                */function A(t,n){let e=t,s=n;const o=X(H,"chats");let c=null;return{addChat:async i=>{const g=new Date,a={username:s,room:e,message:i,created_at:$.fromDate(g)};try{return await E(o,a)}catch(l){console.log("Error addchat = ",l)}},getChats:i=>{c&&c(),c=q(L(o,Y("room","==",e),O("created_at")),g=>{g.docChanges().forEach(a=>{console.log(a),a.type==="added"&&i(a.doc.data())})})},updateChatroom:i=>{e=i,console.log(`Room changed to ${e}`)},updateUsername:i=>{s=i,localStorage.setItem("username",s),console.log(localStorage),console.log(`Username Changed to ${s}`)}}}function p(t,n){const e=+h(t)-+h(n);return e<0?-1:e>0?1:e}function N(t,n,e){const[s,o]=b(e?.in,t,n),c=s.getFullYear()-o.getFullYear(),u=s.getMonth()-o.getMonth();return c*12+u}function R(t){return n=>{const s=(t?Math[t]:Math.trunc)(n);return s===0?0:s}}function z(t,n){return+h(t)-+h(n)}function j(t,n){const e=h(t,n?.in);return e.setHours(23,59,59,999),e}function k(t,n){const e=h(t,n?.in),s=e.getMonth();return e.setFullYear(e.getFullYear(),s+1,0),e.setHours(23,59,59,999),e}function G(t,n){const e=h(t,n?.in);return+j(e,n)==+k(e,n)}function B(t,n,e){const[s,o,c]=b(e?.in,t,t,n),u=p(o,c),r=Math.abs(N(o,c));if(r<1)return 0;o.getMonth()===1&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-u*r);let m=p(o,c)===-u;G(s)&&r===1&&p(s,c)===1&&(m=!1);const d=u*(r-+m);return d===0?0:d}function J(t,n,e){const s=z(t,n)/1e3;return R(e?.roundingMethod)(s)}function K(t,n,e){const s=F(),o=e?.locale??s.locale??U,c=2520,u=p(t,n);if(isNaN(u))throw new RangeError("Invalid time value");const r=Object.assign({},e,{addSuffix:e?.addSuffix,comparison:u}),[m,d]=b(e?.in,...u>0?[n,t]:[t,n]),i=J(d,m),g=(C(d)-C(m))/1e3,a=Math.round((i-g)/60);let l;if(a<2)return e?.includeSeconds?i<5?o.formatDistance("lessThanXSeconds",5,r):i<10?o.formatDistance("lessThanXSeconds",10,r):i<20?o.formatDistance("lessThanXSeconds",20,r):i<40?o.formatDistance("halfAMinute",0,r):i<60?o.formatDistance("lessThanXMinutes",1,r):o.formatDistance("xMinutes",1,r):a===0?o.formatDistance("lessThanXMinutes",1,r):o.formatDistance("xMinutes",a,r);if(a<45)return o.formatDistance("xMinutes",a,r);if(a<90)return o.formatDistance("aboutXHours",1,r);if(a<T){const f=Math.round(a/60);return o.formatDistance("aboutXHours",f,r)}else{if(a<c)return o.formatDistance("xDays",1,r);if(a<y){const f=Math.round(a/T);return o.formatDistance("xDays",f,r)}else if(a<y*2)return l=Math.round(a/y),o.formatDistance("aboutXMonths",l,r)}if(l=B(d,m),l<12){const f=Math.round(a/y);return o.formatDistance("xMonths",f,r)}else{const f=l%12,x=Math.trunc(l/12);return f<3?o.formatDistance("aboutXYears",x,r):f<9?o.formatDistance("overXYears",x,r):o.formatDistance("almostXYears",x+1,r)}}function P(t){const n=s=>{const o=K(s.created_at.toDate(),new Date,{addSuffix:!0}),c=`    <li class="shadow rounded-lg px-4 py-2">
                                <div class="flex justify-between">
                                     <h5 class="text-gray-600 font-medium text-sm">${s.username}/h5>
                                     <i class="text-gray-300 text-xs">${o}</i>
                                </div>
                                <p class="text-gray-600 text-sm">${s.message}</p>
                            </li>`;t.innerHTML+=c};function e(){t.innerHTML=""}return{newli:n,clearli:e}}const Q=document.querySelector(".chatrooms"),V=document.querySelector(".chat-ul"),w=document.querySelector(".chat-form"),D=document.querySelector(".user-form"),v=document.querySelector(".msg"),I=document.querySelector(".roomtitle"),_=localStorage.getItem("username")?localStorage.getItem("username"):"Guest";D.username.placeholder=`username is ${_}`;const M=A("general",_);I.textContent="General";const S=P(V);console.log(S);w.addEventListener("submit",t=>{t.preventDefault();const n=w.message.value.trim();M.addChat(n).then(()=>w.reset()).catch(e=>console.log(e))});D.addEventListener("submit",t=>{t.preventDefault();const n=D.username.value.trim();M.updateUsername(n),D.reset(),v.innerText=`New name updated to ${n}`,D.username.placeholder=`username is ${n}`,setTimeout(()=>v.innerText="",3e3)});Q.addEventListener("click",t=>{t.preventDefault();const n=t.target.closest("button");if(console.log(n),n){const e=n.getAttribute("id");console.log(e);const s=n.querySelector("h3").innerText;I.textContent=s,S.clearli(),M.updateChatroom(e),M.getChats(o=>{console.log(o),S.newli(o)})}});M.getChats(t=>{console.log(t),S.newli(t)});
